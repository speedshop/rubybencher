  [1m[35mSQL (0.5ms)[0m  [1m[35mSET search_path TO public[0m
  [1m[35m (52.4ms)[0m  [1m[35mCREATE DATABASE "orchestrator_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.8ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql" SCHEMA pg_catalog[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "runs" CASCADE[0m
  [1m[35m (28.3ms)[0m  [1m[35mCREATE TABLE "runs" ("id" bigserial primary key, "created_at" timestamp(6) NOT NULL, "external_id" bigint NOT NULL, "gzip_url" character varying, "ruby_version" character varying NOT NULL, "runs_per_instance_type" integer NOT NULL, "status" character varying DEFAULT 'running' NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (9.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_runs_on_external_id" ON "runs" ("external_id")[0m
  [1m[35m (7.7ms)[0m  [1m[35mCREATE INDEX "index_runs_on_status" ON "runs" ("status")[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "tasks" CASCADE[0m
  [1m[35m (18.4ms)[0m  [1m[35mCREATE TABLE "tasks" ("id" bigserial primary key, "claimed_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "current_benchmark" character varying, "error_message" text, "error_type" character varying, "heartbeat_at" timestamp(6), "heartbeat_message" text, "heartbeat_status" character varying, "instance_type" character varying NOT NULL, "progress_pct" integer, "provider" character varying NOT NULL, "run_id" bigint NOT NULL, "run_number" integer NOT NULL, "runner_id" character varying, "s3_error_key" character varying, "s3_result_key" character varying, "status" character varying DEFAULT 'pending' NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (5.5ms)[0m  [1m[35mCREATE INDEX "index_tasks_on_heartbeat_at" ON "tasks" ("heartbeat_at")[0m
  [1m[35m (5.6ms)[0m  [1m[35mCREATE INDEX "index_tasks_on_provider_and_instance_type_and_status" ON "tasks" ("provider", "instance_type", "status")[0m
  [1m[35m (5.9ms)[0m  [1m[35mCREATE INDEX "index_tasks_on_run_id_and_status" ON "tasks" ("run_id", "status")[0m
  [1m[35m (9.5ms)[0m  [1m[35mCREATE INDEX "index_tasks_on_run_id" ON "tasks" ("run_id")[0m
  [1m[35m (10.1ms)[0m  [1m[35mCREATE INDEX "index_tasks_on_runner_id" ON "tasks" ("runner_id")[0m
  [1m[35m (4.9ms)[0m  [1m[35mALTER TABLE "tasks" ADD CONSTRAINT "fk_rails_12dbdd8b0e"
FOREIGN KEY ("run_id")
  REFERENCES "runs" ("id")
[0m
  [1m[35m (12.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (2.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (3.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251211005500)[0m
  [1m[35m (3.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251211005452);[0m
  [1m[35m (14.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (3.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-12-11 01:00:59.585600', '2025-12-11 01:00:59.585602') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (2.6ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '56717c5e97f56f1b162b8f1c562078764b9e27e3', '2025-12-11 01:00:59.591373', '2025-12-11 01:00:59.591374') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.3ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.073208', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.073208'), (298486374, '2025-12-11 01:01:05.073208', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.073208');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.078906', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.078906'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.078906', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.078906')[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.0ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.089263', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.089263'), (298486374, '2025-12-11 01:01:05.089263', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.089263');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.089292', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.089292'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.089292', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.089292')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.5ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.093735', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.093735'), (298486374, '2025-12-11 01:01:05.093735', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.093735');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.093752', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.093752'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.093752', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.093752')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (2.4ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.098943', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.098943'), (298486374, '2025-12-11 01:01:05.098943', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.098943');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.098958', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.098958'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.098958', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.098958')[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.105216', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.105216'), (298486374, '2025-12-11 01:01:05.105216', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.105216');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.105235', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.105235'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.105235', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.105235')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.109703', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.109703'), (298486374, '2025-12-11 01:01:05.109703', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.109703');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.109717', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.109717'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.109717', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.109717')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.113971', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.113971'), (298486374, '2025-12-11 01:01:05.113971', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.113971');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.113986', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.113986'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.113986', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.113986')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.1ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.119104', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.119104'), (298486374, '2025-12-11 01:01:05.119104', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.119104');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.119124', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.119124'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.119124', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.119124')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.146881', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.146881'), (298486374, '2025-12-11 01:01:05.146881', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.146881');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.146926', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.146926'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.146926', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.146926')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.0ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.190944', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.190944'), (298486374, '2025-12-11 01:01:05.190944', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.190944');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.190989', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.190989'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.190989', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.190989')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.1ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.196700', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.196700'), (298486374, '2025-12-11 01:01:05.196700', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.196700');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.196731', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.196731'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.196731', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.196731')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.201075', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.201075'), (298486374, '2025-12-11 01:01:05.201075', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.201075');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.201090', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.201090'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.201090', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.201090')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.7ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.205370', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.205370'), (298486374, '2025-12-11 01:01:05.205370', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.205370');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.205390', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.205390'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.205390', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.205390')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.1ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.209189', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.209189'), (298486374, '2025-12-11 01:01:05.209189', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.209189');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.209213', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.209213'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.209213', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.209213')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.2ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.213553', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.213553'), (298486374, '2025-12-11 01:01:05.213553', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.213553');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.213584', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.213584'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.213584', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.213584')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.220588', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.220588'), (298486374, '2025-12-11 01:01:05.220588', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.220588');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.220635', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.220635'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.220635', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.220635')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.225362', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.225362'), (298486374, '2025-12-11 01:01:05.225362', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.225362');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.225385', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.225385'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.225385', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.225385')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.229846', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.229846'), (298486374, '2025-12-11 01:01:05.229846', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.229846');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.229869', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.229869'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.229869', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.229869')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.8ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.234205', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.234205'), (298486374, '2025-12-11 01:01:05.234205', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.234205');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.234223', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.234223'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.234223', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.234223')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.1ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.239108', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.239108'), (298486374, '2025-12-11 01:01:05.239108', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.239108');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.239129', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.239129'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.239129', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.239129')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.0ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.243296', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.243296'), (298486374, '2025-12-11 01:01:05.243296', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.243296');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.243314', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.243314'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.243314', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.243314')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.8ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.247837', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.247837'), (298486374, '2025-12-11 01:01:05.247837', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.247837');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.247870', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.247870'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.247870', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.247870')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.252273', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.252273'), (298486374, '2025-12-11 01:01:05.252273', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.252273');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.252306', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.252306'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.252306', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.252306')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.8ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.256651', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.256651'), (298486374, '2025-12-11 01:01:05.256651', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.256651');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.256674', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.256674'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.256674', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.256674')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.8ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.260779', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.260779'), (298486374, '2025-12-11 01:01:05.260779', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.260779');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.260804', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.260804'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.260804', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.260804')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.7ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.264396', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.264396'), (298486374, '2025-12-11 01:01:05.264396', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.264396');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.264420', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.264420'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.264420', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.264420')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.7ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.268029', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.268029'), (298486374, '2025-12-11 01:01:05.268029', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.268029');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.268047', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.268047'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.268047', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.268047')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.0ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.272110', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.272110'), (298486374, '2025-12-11 01:01:05.272110', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.272110');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.272148', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.272148'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.272148', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.272148')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.5ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.276453', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.276453'), (298486374, '2025-12-11 01:01:05.276453', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.276453');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.276476', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.276476'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.276476', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.276476')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.0ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.281299', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.281299'), (298486374, '2025-12-11 01:01:05.281299', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.281299');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.281322', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.281322'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.281322', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.281322')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.285547', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.285547'), (298486374, '2025-12-11 01:01:05.285547', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.285547');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.285564', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.285564'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.285564', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.285564')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.8ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.290181', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.290181'), (298486374, '2025-12-11 01:01:05.290181', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.290181');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.290212', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.290212'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.290212', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.290212')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.7ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks";
INSERT INTO "runs" ("id", "created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES (980190962, '2025-12-11 01:01:05.294069', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.294069'), (298486374, '2025-12-11 01:01:05.294069', NULL, 'MyString', 'MyString', 1, 'MyString', '2025-12-11 01:01:05.294069');
INSERT INTO "tasks" ("id", "claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES (980190962, '2025-12-11 09:55:00', '2025-12-11 01:01:05.294090', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 980190962, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.294090'), (298486374, '2025-12-11 09:55:00', '2025-12-11 01:01:05.294090', 'MyString', 'MyText', 'MyString', '2025-12-11 09:55:00', 'MyText', 'MyString', 'MyString', 1, 'MyString', 298486374, 1, 'MyString', 'MyString', 'MyString', 'MyString', '2025-12-11 01:01:05.294090')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.1ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "runs" ENABLE TRIGGER ALL;ALTER TABLE "tasks" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (9.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (12.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (4.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
RunTest: test_creates_run_with_external_id
------------------------------------------
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (1.1ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.147670"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.147670"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
RunTest: test_cancel!_changes_status_to_cancelled
-------------------------------------------------
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.155357"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.155357"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (0.9ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:01:29.160845"], ["id", 2]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
RunTest: test_validates_runs_per_instance_type_is_positive
----------------------------------------------------------
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
---------------------------------------
RunTest: test_validates_status_is_valid
---------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.174244"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.174244"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_complete!_changes_status_to_completed
---------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.179612"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.179612"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.3ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:01:29.181045"], ["id", 4]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
RunTest: test_current_scope_returns_most_recent_running_run
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.186001"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.186001"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.1ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:01:29.187549"], ["id", 5]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_validates_presence_of_required_fields
---------------------------------------------------
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_creates_a_new_run_with_tasks
---------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2, "aws" => ["c8g.medium"], "azure" => ["Standard_D2pls_v6"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2}}
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.291476"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.291476"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.306601"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 6], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.306601"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.309050"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 6], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.309050"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.310539"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 6], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.310539"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.311994"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 6], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.311994"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 39ms (Views: 0.1ms | ActiveRecord: 12.0ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (1.7ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_404_if_no_run_exists
--------------------------------------------------------------
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.9ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_requires_authentication
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.324831"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.324831"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_cancels_the_current_run
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.4ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.328515"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.328515"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.2ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:01:29.330519"], ["id", 8]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.0ms | ActiveRecord: 2.6ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (1.0ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_409_if_run_already_in_progress
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.337160"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.337160"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1}}
  [1m[36mRun Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 409 Conflict in 1ms (Views: 0.0ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_current_run_status
------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.342484"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.342484"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.344297"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 10], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:01:29.344297"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.346491"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 10], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.346491"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.7ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTask Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "tasks"."status" AS "tasks_status" FROM "tasks" WHERE "tasks"."run_id" = $1 GROUP BY "tasks"."status"[0m  [["run_id", 10]]
  [1m[36mTask Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1[0m  [["run_id", 10]]
Completed 200 OK in 3ms (Views: 0.0ms | ActiveRecord: 1.9ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_requires_authentication
----------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_400_if_no_instance_types_specified
-----------------------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
  [1m[36mRun Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 400 Bad Request in 1ms (Views: 0.0ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
TaskTest: test_creates_task_with_default_pending_status
-------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.361798"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.361798"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.363182"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 11], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.363182"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
TaskTest: test_claim!_updates_task_status_and_timestamps
--------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.367591"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.367591"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.368670"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 12], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.368670"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (2.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.370195"], ["heartbeat_at", "2025-12-11 01:01:29.370201"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.370292"], ["id", 8]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
TaskTest: test_update_heartbeat!_updates_status_and_timestamps
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.375850"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.375850"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.376926"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 13], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.376926"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.378346"], ["heartbeat_at", "2025-12-11 01:01:29.378353"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.378439"], ["id", 9]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:01:29.379951"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 45], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.380036"], ["id", 9]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
TaskTest: test_stale_heartbeats_scope_finds_tasks_with_old_heartbeats
---------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.384554"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.384554"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.385796"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 14], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.385796"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.8ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.387051"], ["heartbeat_at", "2025-12-11 01:01:29.387057"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.387137"], ["id", 10]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.388536"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 14], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.388536"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.389979"], ["heartbeat_at", "2025-12-11 01:01:29.389986"], ["runner_id", "runner-456"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.390074"], ["id", 11]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.5ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_at" = $1 WHERE "tasks"."id" = $2[0m  [["heartbeat_at", "2025-12-11 00:58:29.391345"], ["id", 11]]
  [1m[36mTask Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 00:59:29.391952"], ["id", 10], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 00:59:29.391952"], ["id", 11], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TaskTest: test_mark_timeout_failed!_marks_task_as_failed_due_to_timeout
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.4ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.396217"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.396217"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.397311"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 15], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.397311"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.398884"], ["heartbeat_at", "2025-12-11 01:01:29.398890"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.398984"], ["id", 12]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["error_message", "No heartbeat received for 2 minutes. Last heartbeat: 2025-12-11 01:01:29 UTC"], ["error_type", "timeout"], ["heartbeat_status", "error"], ["status", "failed"], ["updated_at", "2025-12-11 01:01:29.400704"], ["id", 12]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
TaskTest: test_complete!_marks_task_as_completed
------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.404971"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.404971"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.406187"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 16], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.406187"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.8ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.407857"], ["heartbeat_at", "2025-12-11 01:01:29.407863"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.407946"], ["id", 13]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:01:29.409381"], ["id", 13]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_fail!_marks_task_as_failed_with_error_details
------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.413220"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.413220"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.414871"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 17], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.414871"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.417513"], ["heartbeat_at", "2025-12-11 01:01:29.417521"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.417609"], ["id", 14]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed to run"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:01:29.419455"], ["id", 14]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_for_provider_and_type_scope_filters_correctly
------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (1.1ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.423428"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.423428"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.425285"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 18], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.425285"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.426920"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 18], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.426920"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 15], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 16], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_wait_when_tasks_are_in_progress
-----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.432593"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.432593"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.433874"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 19], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.433874"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.435819"], ["heartbeat_at", "2025-12-11 01:01:29.435829"], ["runner_id", "other-runner"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.435943"], ["id", 17]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.1ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 19], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 19], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.0ms | ActiveRecord: 2.9ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_done_when_all_tasks_completed
---------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.446367"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.446367"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.447712"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 20], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.447712"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (2.7ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.449387"], ["heartbeat_at", "2025-12-11 01:01:29.449392"], ["runner_id", "runner-1"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.449476"], ["id", 18]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:01:29.452745"], ["id", 18]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.1ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 20], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 20], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 4.2ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_marks_task_as_completed
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.463069"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.463069"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.464563"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 21], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.464563"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.8ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.466390"], ["heartbeat_at", "2025-12-11 01:01:29.466397"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.466508"], ["id", 19]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_marks_task_as_failed
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.470505"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.470505"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.471918"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 22], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.471918"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.473559"], ["heartbeat_at", "2025-12-11 01:01:29.473566"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.473668"], ["id", 20]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_validates_runner_id
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.478338"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.478338"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.479819"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 23], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.479819"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.481536"], ["heartbeat_at", "2025-12-11 01:01:29.481542"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.481639"], ["id", 21]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_assigns_a_task
----------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.486789"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.486789"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.488128"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 24], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.488128"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.1ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 24], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Update (0.8ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.492796"], ["heartbeat_at", "2025-12-11 01:01:29.492804"], ["runner_id", "i-12345"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.492935"], ["id", 22]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 7ms (ActiveRecord: 3.4ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_validates_runner_id
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.501660"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.501660"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.5ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.503104"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 25], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.503104"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.505458"], ["heartbeat_at", "2025-12-11 01:01:29.505467"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.505634"], ["id", 23]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_requires_authentication
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.4ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.510116"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.510116"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.511414"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 26], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.511414"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:01:29 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_validates_runner_id
------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.517937"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.517937"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.519412"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 27], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.519412"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.521078"], ["heartbeat_at", "2025-12-11 01:01:29.521085"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.521191"], ["id", 25]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_updates_task_heartbeat
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414889], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:01:29.526052"], ["external_id", 1765414889], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:01:29.526052"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:01:29.527388"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 28], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:01:29.527388"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.8ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:01:29.528832"], ["heartbeat_at", "2025-12-11 01:01:29.528840"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:01:29.528948"], ["id", 26]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.7ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" ENABLE TRIGGER ALL;ALTER TABLE "tasks" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (20.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.3ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (5.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_validates_runner_id
----------------------------------------------------------------------
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (1.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.518249"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.518249"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.7ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.530592"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 1], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.530592"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.533470"], ["heartbeat_at", "2025-12-11 01:02:15.533498"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.533776"], ["id", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/1/complete" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#complete as JSON
  Parameters: {"runner_id" => "wrong-runner", "s3_result_key" => "[FILTERED]", "id" => "1", "task" => {"runner_id" => "wrong-runner", "s3_result_key" => "[FILTERED]"}}
  [1m[36mTask Load (1.8ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 5ms (Views: 0.1ms | ActiveRecord: 2.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_marks_task_as_completed
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.568694"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.568694"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.570481"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 2], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.570481"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.8ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.572324"], ["heartbeat_at", "2025-12-11 01:02:15.572329"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.572436"], ["id", 2]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/2/complete" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#complete as JSON
  Parameters: {"runner_id" => "runner-123", "s3_result_key" => "[FILTERED]", "id" => "2", "task" => {"runner_id" => "runner-123", "s3_result_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:02:15.575209"], ["id", 2]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (1.3ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTask Count (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."status" IN ($2, $3, $4)[0m  [["run_id", 2], ["status", "pending"], ["status", "claimed"], ["status", "running"]]
[ActiveJob] Enqueued GzipBuilderJob (Job ID: 94e44062-c997-4393-b68c-4265a46eb10e) to Test(default) with arguments: 2
Completed 200 OK in 7ms (Views: 0.0ms | ActiveRecord: 5.2ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.7ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_marks_task_as_failed
-------------------------------------------------------------------
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.587375"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.587375"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.588946"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 3], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.588946"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.591033"], ["heartbeat_at", "2025-12-11 01:02:15.591039"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.591130"], ["id", 3]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/3/fail" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#fail as JSON
  Parameters: {"runner_id" => "runner-123", "error_type" => "benchmark_error", "error_message" => "Benchmark failed", "s3_error_key" => "[FILTERED]", "id" => "3", "task" => {"error_message" => "Benchmark failed", "error_type" => "benchmark_error", "runner_id" => "runner-123", "s3_error_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.8ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:02:15.594408"], ["id", 3]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mTask Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."status" IN ($2, $3, $4)[0m  [["run_id", 3], ["status", "pending"], ["status", "claimed"], ["status", "running"]]
[ActiveJob] Enqueued GzipBuilderJob (Job ID: fbc0f937-1eae-4ba2-a4d3-dee038d1f4d2) to Test(default) with arguments: 3
Completed 200 OK in 5ms (Views: 0.0ms | ActiveRecord: 4.1ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_validates_runner_id
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.602675"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.602675"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.604366"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 4], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.604366"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.606476"], ["heartbeat_at", "2025-12-11 01:02:15.606481"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.606562"], ["id", 4]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/4/heartbeat" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#heartbeat as JSON
  Parameters: {"runner_id" => "wrong-runner", "status" => "running", "id" => "4", "task" => {"runner_id" => "wrong-runner", "status" => "running"}}
  [1m[36mTask Load (0.7ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.0ms | ActiveRecord: 0.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_assigns_a_task
----------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.613244"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.613244"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (2.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.614756"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 5], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.614756"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (1.0ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.3ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 5], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Update (0.7ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.620874"], ["heartbeat_at", "2025-12-11 01:02:15.620880"], ["runner_id", "i-12345"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.620986"], ["id", 5]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.0ms | ActiveRecord: 3.6ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_updates_task_heartbeat
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.628973"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.628973"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.630458"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 6], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.630458"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.632451"], ["heartbeat_at", "2025-12-11 01:02:15.632457"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.632546"], ["id", 6]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/6/heartbeat" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#heartbeat as JSON
  Parameters: {"runner_id" => "runner-123", "status" => "running", "current_benchmark" => "optcarrot", "progress_pct" => 50, "message" => "Running benchmark", "id" => "6", "task" => {"current_benchmark" => "optcarrot", "progress_pct" => 50, "runner_id" => "runner-123", "status" => "running"}}
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:02:15.635284"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 50], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.635406"], ["id", 6]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.0ms | ActiveRecord: 2.3ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.6ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_requires_authentication
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (1.0ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.642439"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.642439"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.644376"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 7], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.644376"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_validates_runner_id
------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.650335"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.650335"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.651866"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 8], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.651866"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.653564"], ["heartbeat_at", "2025-12-11 01:02:15.653570"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.653668"], ["id", 8]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/8/fail" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#fail as JSON
  Parameters: {"runner_id" => "wrong-runner", "error_type" => "benchmark_error", "error_message" => "Benchmark failed", "id" => "8", "task" => {"error_message" => "Benchmark failed", "error_type" => "benchmark_error", "runner_id" => "wrong-runner"}}
  [1m[36mTask Load (0.4ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.0ms | ActiveRecord: 0.4ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_wait_when_tasks_are_in_progress
-----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.659250"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.659250"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.660436"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 9], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.660436"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.661800"], ["heartbeat_at", "2025-12-11 01:02:15.661806"], ["runner_id", "other-runner"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.661895"], ["id", 9]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.0ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 9], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 9], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.0ms | ActiveRecord: 3.0ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_done_when_all_tasks_completed
---------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.669838"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.669838"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.671158"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 10], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.671158"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (2.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:15.673192"], ["heartbeat_at", "2025-12-11 01:02:15.673198"], ["runner_id", "runner-1"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:15.673288"], ["id", 10]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:02:15.675985"], ["id", 10]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.3ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 10], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 10], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.0ms | ActiveRecord: 3.5ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_requires_authentication
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.685275"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.685275"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_400_if_no_instance_types_specified
-----------------------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
  [1m[36mRun Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 400 Bad Request in 1ms (Views: 0.0ms | ActiveRecord: 0.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_cancels_the_current_run
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.696050"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.696050"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (0.6ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:02:15.701296"], ["id", 12]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.0ms | ActiveRecord: 4.8ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_409_if_run_already_in_progress
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.709564"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.709564"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1}}
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 409 Conflict in 1ms (Views: 0.0ms | ActiveRecord: 0.8ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_current_run_status
------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.716820"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.716820"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.718527"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 14], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:02:15.718527"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.720385"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 14], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.720385"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTask Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "tasks"."status" AS "tasks_status" FROM "tasks" WHERE "tasks"."run_id" = $1 GROUP BY "tasks"."status"[0m  [["run_id", 14]]
  [1m[36mTask Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1[0m  [["run_id", 14]]
Completed 200 OK in 2ms (Views: 0.0ms | ActiveRecord: 1.4ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_requires_authentication
----------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_404_if_no_run_exists
--------------------------------------------------------------
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.9ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_creates_a_new_run_with_tasks
---------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:02:15 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2, "aws" => ["c8g.medium"], "azure" => ["Standard_D2pls_v6"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2}}
  [1m[36mRun Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.736363"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.736363"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.737989"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 15], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.737989"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.740488"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 15], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.740488"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.742434"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 15], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.742434"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:15.744399"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 15], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:15.744399"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 13ms (Views: 0.0ms | ActiveRecord: 12.3ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (1.1ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
RunTest: test_validates_runs_per_instance_type_is_positive
----------------------------------------------------------
  [1m[36mRun Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[35mBEGIN[0m
---------------------------------------
RunTest: test_validates_status_is_valid
---------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.759287"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.759287"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_validates_presence_of_required_fields
---------------------------------------------------
  [1m[36mRun Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_complete!_changes_status_to_completed
---------------------------------------------------
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.3ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.769991"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.769991"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (0.4ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:02:15.770902"], ["id", 17]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
RunTest: test_current_scope_returns_most_recent_running_run
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414935], ["LIMIT", 1]]
  [1m[36mRun Create (0.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:15.774643"], ["external_id", 1765414935], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:15.774643"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (0.4ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:02:15.775382"], ["id", 18]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (1.1ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.780762"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.8"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.780762"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (1.1ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
RunTest: test_cancel!_changes_status_to_cancelled
-------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.791698"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.791698"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.2ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:02:16.795133"], ["id", 20]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
RunTest: test_creates_run_with_external_id
------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (2.1ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.802390"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.802390"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
TaskTest: test_update_heartbeat!_updates_status_and_timestamps
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.818249"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.818249"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (2.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.822328"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 22], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.822328"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:16.826619"], ["heartbeat_at", "2025-12-11 01:02:16.826650"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:16.827329"], ["id", 17]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:02:16.829837"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 45], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.830145"], ["id", 17]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_for_provider_and_type_scope_filters_correctly
------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (1.1ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.838141"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.838141"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.842162"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 23], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.842162"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.846068"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 23], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.846068"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 18], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 19], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
TaskTest: test_stale_heartbeats_scope_finds_tasks_with_old_heartbeats
---------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.857317"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.857317"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.861011"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 24], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.861011"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:16.864525"], ["heartbeat_at", "2025-12-11 01:02:16.864542"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:16.864845"], ["id", 20]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.867670"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 24], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.867670"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (2.8ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:16.870011"], ["heartbeat_at", "2025-12-11 01:02:16.870060"], ["runner_id", "runner-456"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:16.870886"], ["id", 21]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_at" = $1 WHERE "tasks"."id" = $2[0m  [["heartbeat_at", "2025-12-11 00:59:16.876783"], ["id", 21]]
  [1m[36mTask Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 01:00:16.878452"], ["id", 20], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 01:00:16.878452"], ["id", 21], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TaskTest: test_mark_timeout_failed!_marks_task_as_failed_due_to_timeout
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.887326"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.887326"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.890727"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 25], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.890727"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.8ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:16.893782"], ["heartbeat_at", "2025-12-11 01:02:16.893810"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:16.894179"], ["id", 22]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["error_message", "No heartbeat received for 2 minutes. Last heartbeat: 2025-12-11 01:02:16 UTC"], ["error_type", "timeout"], ["heartbeat_status", "error"], ["status", "failed"], ["updated_at", "2025-12-11 01:02:16.897759"], ["id", 22]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
TaskTest: test_complete!_marks_task_as_completed
------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (1.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.905364"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.905364"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.909919"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 26], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.909919"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:16.912514"], ["heartbeat_at", "2025-12-11 01:02:16.912538"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:16.912865"], ["id", 23]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:02:16.916098"], ["id", 23]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_fail!_marks_task_as_failed_with_error_details
------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.925286"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.925286"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.927798"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 27], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.927798"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:16.930237"], ["heartbeat_at", "2025-12-11 01:02:16.930251"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:16.930458"], ["id", 24]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed to run"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:02:16.932743"], ["id", 24]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
TaskTest: test_claim!_updates_task_status_and_timestamps
--------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.938404"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.938404"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.940299"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 28], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.940299"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:16.943072"], ["heartbeat_at", "2025-12-11 01:02:16.943085"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:16.943280"], ["id", 25]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
TaskTest: test_creates_task_with_default_pending_status
-------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414936], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:16.949348"], ["external_id", 1765414936], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:16.949348"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:16.953361"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 29], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:16.953361"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.3ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "runs" ENABLE TRIGGER ALL;ALTER TABLE "tasks" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (9.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (4.0ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (3.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
TaskTest: test_claim!_updates_task_status_and_timestamps
--------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.3ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.855073"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.855073"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.865843"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 1], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.865843"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.5ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.867251"], ["heartbeat_at", "2025-12-11 01:02:47.867260"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.867377"], ["id", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_for_provider_and_type_scope_filters_correctly
------------------------------------------------------------
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.871258"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.871258"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.872148"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 2], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.872148"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.873113"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 2], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.873113"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 2], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 3], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
TaskTest: test_creates_task_with_default_pending_status
-------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.876322"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.876322"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.877164"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 3], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.877164"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
TaskTest: test_complete!_marks_task_as_completed
------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.879310"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.879310"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.880026"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 4], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.880026"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.880806"], ["heartbeat_at", "2025-12-11 01:02:47.880813"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.880907"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:02:47.882015"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TaskTest: test_mark_timeout_failed!_marks_task_as_failed_due_to_timeout
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.884654"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.884654"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.885417"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 5], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.885417"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.886156"], ["heartbeat_at", "2025-12-11 01:02:47.886164"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.886265"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.4ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["error_message", "No heartbeat received for 2 minutes. Last heartbeat: 2025-12-11 01:02:47 UTC"], ["error_type", "timeout"], ["heartbeat_status", "error"], ["status", "failed"], ["updated_at", "2025-12-11 01:02:47.887102"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
TaskTest: test_update_heartbeat!_updates_status_and_timestamps
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.889588"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.889588"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.890386"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 6], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.890386"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.891137"], ["heartbeat_at", "2025-12-11 01:02:47.891142"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.891227"], ["id", 7]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.4ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:02:47.891923"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 45], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.892007"], ["id", 7]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
TaskTest: test_stale_heartbeats_scope_finds_tasks_with_old_heartbeats
---------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.894045"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.894045"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.894832"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 7], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.894832"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.895652"], ["heartbeat_at", "2025-12-11 01:02:47.895658"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.895754"], ["id", 8]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.5ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.896969"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 7], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.896969"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.897941"], ["heartbeat_at", "2025-12-11 01:02:47.897949"], ["runner_id", "runner-456"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.898067"], ["id", 9]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.2ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_at" = $1 WHERE "tasks"."id" = $2[0m  [["heartbeat_at", "2025-12-11 00:59:47.898924"], ["id", 9]]
  [1m[36mTask Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 01:00:47.899279"], ["id", 8], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 01:00:47.899279"], ["id", 9], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_fail!_marks_task_as_failed_with_error_details
------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.901550"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.901550"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.902336"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 8], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.902336"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.6ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.903066"], ["heartbeat_at", "2025-12-11 01:02:47.903071"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.903153"], ["id", 10]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.3ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed to run"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:02:47.904143"], ["id", 10]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_validates_runner_id
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.921390"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.921390"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.923685"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 9], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.923685"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.925684"], ["heartbeat_at", "2025-12-11 01:02:47.925703"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.925898"], ["id", 11]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/11/complete" for 127.0.0.1 at 2025-12-11 10:02:47 +0900
Processing by TasksController#complete as JSON
  Parameters: {"runner_id" => "wrong-runner", "s3_result_key" => "[FILTERED]", "id" => "11", "task" => {"runner_id" => "wrong-runner", "s3_result_key" => "[FILTERED]"}}
  [1m[36mTask Load (2.0ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
Completed 403 Forbidden in 6ms (Views: 0.1ms | ActiveRecord: 2.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_done_when_all_tasks_completed
---------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.958121"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.958121"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.959819"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 10], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.959819"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.961781"], ["heartbeat_at", "2025-12-11 01:02:47.961788"], ["runner_id", "runner-1"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.961891"], ["id", 12]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:02:47.963856"], ["id", 12]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:02:47 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (1.4ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.2ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 10], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 10], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.0ms | ActiveRecord: 4.2ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_updates_task_heartbeat
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.974735"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.974735"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.976141"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 11], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.976141"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.977627"], ["heartbeat_at", "2025-12-11 01:02:47.977632"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.977719"], ["id", 13]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/13/heartbeat" for 127.0.0.1 at 2025-12-11 10:02:47 +0900
Processing by TasksController#heartbeat as JSON
  Parameters: {"runner_id" => "runner-123", "status" => "running", "current_benchmark" => "optcarrot", "progress_pct" => 50, "message" => "Running benchmark", "id" => "13", "task" => {"current_benchmark" => "optcarrot", "progress_pct" => 50, "runner_id" => "runner-123", "status" => "running"}}
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.8ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:02:47.980363"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 50], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.980500"], ["id", 13]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.0ms | ActiveRecord: 1.9ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.4ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_assigns_a_task
----------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.985320"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.985320"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.986575"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 12], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.986575"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:02:47 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (0.9ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 12], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Update (0.6ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:47.990301"], ["heartbeat_at", "2025-12-11 01:02:47.990306"], ["runner_id", "i-12345"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:47.990407"], ["id", 14]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.0ms | ActiveRecord: 2.7ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.6ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_requires_authentication
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414967], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:47.996676"], ["external_id", 1765414967], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:47.996676"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:47.998262"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 13], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:47.998262"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_marks_task_as_completed
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.004839"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.004839"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.006251"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 14], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.006251"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:48.008211"], ["heartbeat_at", "2025-12-11 01:02:48.008217"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:48.008307"], ["id", 16]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/16/complete" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by TasksController#complete as JSON
  Parameters: {"runner_id" => "runner-123", "s3_result_key" => "[FILTERED]", "id" => "16", "task" => {"runner_id" => "runner-123", "s3_result_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.6ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:02:48.011356"], ["id", 16]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (1.1ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mTask Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."status" IN ($2, $3, $4)[0m  [["run_id", 14], ["status", "pending"], ["status", "claimed"], ["status", "running"]]
[ActiveJob] Enqueued GzipBuilderJob (Job ID: 055324c1-d2fc-4ffb-b458-d2083cac13a5) to Test(default) with arguments: 14
Completed 200 OK in 6ms (Views: 0.0ms | ActiveRecord: 4.4ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.7ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_marks_task_as_failed
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.021046"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.021046"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.022892"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 15], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.022892"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.5ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:48.024949"], ["heartbeat_at", "2025-12-11 01:02:48.024955"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:48.025056"], ["id", 17]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/17/fail" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by TasksController#fail as JSON
  Parameters: {"runner_id" => "runner-123", "error_type" => "benchmark_error", "error_message" => "Benchmark failed", "s3_error_key" => "[FILTERED]", "id" => "17", "task" => {"error_message" => "Benchmark failed", "error_type" => "benchmark_error", "runner_id" => "runner-123", "s3_error_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.9ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:02:48.028917"], ["id", 17]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mTask Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."status" IN ($2, $3, $4)[0m  [["run_id", 15], ["status", "pending"], ["status", "claimed"], ["status", "running"]]
[ActiveJob] Enqueued GzipBuilderJob (Job ID: d7213dc3-23a2-46ba-a904-6174e1e57c9d) to Test(default) with arguments: 15
Completed 200 OK in 5ms (Views: 0.0ms | ActiveRecord: 3.7ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.4ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_validates_runner_id
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.036346"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.036346"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.037882"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 16], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.037882"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:48.039562"], ["heartbeat_at", "2025-12-11 01:02:48.039569"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:48.039672"], ["id", 18]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/18/heartbeat" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by TasksController#heartbeat as JSON
  Parameters: {"runner_id" => "wrong-runner", "status" => "running", "id" => "18", "task" => {"runner_id" => "wrong-runner", "status" => "running"}}
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.0ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_wait_when_tasks_are_in_progress
-----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.045089"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.045089"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.046566"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 17], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.046566"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:48.048175"], ["heartbeat_at", "2025-12-11 01:02:48.048180"], ["runner_id", "other-runner"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:48.048261"], ["id", 19]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (0.9ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 17], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 17], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.0ms | ActiveRecord: 2.6ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_validates_runner_id
------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.056304"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.056304"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.057593"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 18], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.057593"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:02:48.059089"], ["heartbeat_at", "2025-12-11 01:02:48.059094"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:02:48.059179"], ["id", 20]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/20/fail" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by TasksController#fail as JSON
  Parameters: {"runner_id" => "wrong-runner", "error_type" => "benchmark_error", "error_message" => "Benchmark failed", "id" => "20", "task" => {"error_message" => "Benchmark failed", "error_type" => "benchmark_error", "runner_id" => "wrong-runner"}}
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.0ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_404_if_no_run_exists
--------------------------------------------------------------
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 404 Not Found in 1ms (Views: 0.0ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_400_if_no_instance_types_specified
-----------------------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
  [1m[36mRun Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 400 Bad Request in 1ms (Views: 0.0ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_creates_a_new_run_with_tasks
---------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2, "aws" => ["c8g.medium"], "azure" => ["Standard_D2pls_v6"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2}}
  [1m[36mRun Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.072003"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.072003"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.073533"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 19], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.073533"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.075224"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 19], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.075224"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.076675"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 19], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.076675"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.078431"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 19], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:02:48.078431"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 10ms (Views: 0.0ms | ActiveRecord: 9.5ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (0.8ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_current_run_status
------------------------------------------------------------
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.089373"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.089373"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.090868"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 20], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:02:48.090868"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:02:48.092485"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 20], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.092485"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTask Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "tasks"."status" AS "tasks_status" FROM "tasks" WHERE "tasks"."run_id" = $1 GROUP BY "tasks"."status"[0m  [["run_id", 20]]
  [1m[36mTask Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1[0m  [["run_id", 20]]
Completed 200 OK in 2ms (Views: 0.0ms | ActiveRecord: 1.8ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_409_if_run_already_in_progress
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.100557"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.100557"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1}}
  [1m[36mRun Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 409 Conflict in 1ms (Views: 0.0ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_requires_authentication
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.106593"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.106593"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_cancels_the_current_run
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.111841"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.111841"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (0.6ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:02:48.117612"], ["id", 23]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.0ms | ActiveRecord: 4.5ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 23], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_requires_authentication
----------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:02:48 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
RunTest: test_cancel!_changes_status_to_cancelled
-------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.127437"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.127437"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.0ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:02:48.128764"], ["id", 24]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_validates_presence_of_required_fields
---------------------------------------------------
  [1m[36mRun Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
RunTest: test_creates_run_with_external_id
------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.141926"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.141926"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_complete!_changes_status_to_completed
---------------------------------------------------
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.146871"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.146871"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.1ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:02:48.148727"], ["id", 26]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
RunTest: test_validates_runs_per_instance_type_is_positive
----------------------------------------------------------
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
---------------------------------------
RunTest: test_validates_status_is_valid
---------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.157890"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.157890"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
RunTest: test_current_scope_returns_most_recent_running_run
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414968], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:48.161852"], ["external_id", 1765414968], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:48.161852"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (0.9ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:02:48.163383"], ["id", 28]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765414969], ["LIMIT", 1]]
  [1m[36mRun Create (1.1ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:02:49.174443"], ["external_id", 1765414969], ["gzip_url", nil], ["ruby_version", "3.4.8"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:02:49.174443"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (0.9ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (1.4ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "runs" ENABLE TRIGGER ALL;ALTER TABLE "tasks" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (24.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.8ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (10.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_done_when_all_tasks_completed
---------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.209326"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.209326"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.7ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.220386"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 1], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.220386"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.224678"], ["heartbeat_at", "2025-12-11 01:05:12.224686"], ["runner_id", "runner-1"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.224810"], ["id", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (2.5ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:05:12.227120"], ["id", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (2.2ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.3ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 1], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 1], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.1ms | ActiveRecord: 5.9ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_updates_task_heartbeat
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.267777"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.267777"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.269441"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 2], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.269441"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.271337"], ["heartbeat_at", "2025-12-11 01:05:12.271344"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.271453"], ["id", 2]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/2/heartbeat" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#heartbeat as JSON
  Parameters: {"runner_id" => "runner-123", "status" => "running", "current_benchmark" => "optcarrot", "progress_pct" => 50, "message" => "Running benchmark", "id" => "2", "task" => {"current_benchmark" => "optcarrot", "progress_pct" => 50, "runner_id" => "runner-123", "status" => "running"}}
  [1m[36mTask Load (1.1ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:05:12.275289"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 50], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.275420"], ["id", 2]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 3.5ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_marks_task_as_failed
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.282025"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.282025"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.283605"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 3], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.283605"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.285389"], ["heartbeat_at", "2025-12-11 01:05:12.285395"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.285493"], ["id", 3]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/3/fail" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#fail as JSON
  Parameters: {"runner_id" => "runner-123", "error_type" => "benchmark_error", "error_message" => "Benchmark failed", "s3_error_key" => "[FILTERED]", "id" => "3", "task" => {"error_message" => "Benchmark failed", "error_type" => "benchmark_error", "runner_id" => "runner-123", "s3_error_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.6ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:05:12.288640"], ["id", 3]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (0.9ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mTask Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."status" IN ($2, $3, $4)[0m  [["run_id", 3], ["status", "pending"], ["status", "claimed"], ["status", "running"]]
[ActiveJob] Enqueued GzipBuilderJob (Job ID: 2d3be2f8-3655-4ecf-ba06-a759dbb93cc0) to Test(default) with arguments: 3
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 4.2ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_validates_runner_id
------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.297722"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.297722"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.299259"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 4], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.299259"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.301273"], ["heartbeat_at", "2025-12-11 01:05:12.301279"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.301378"], ["id", 4]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/4/fail" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#fail as JSON
  Parameters: {"runner_id" => "wrong-runner", "error_type" => "benchmark_error", "error_message" => "Benchmark failed", "id" => "4", "task" => {"error_message" => "Benchmark failed", "error_type" => "benchmark_error", "runner_id" => "wrong-runner"}}
  [1m[36mTask Load (0.6ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.0ms | ActiveRecord: 0.6ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_validates_runner_id
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.307952"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.307952"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.309497"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 5], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.309497"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.311439"], ["heartbeat_at", "2025-12-11 01:05:12.311446"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.311543"], ["id", 5]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/5/complete" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#complete as JSON
  Parameters: {"runner_id" => "wrong-runner", "s3_result_key" => "[FILTERED]", "id" => "5", "task" => {"runner_id" => "wrong-runner", "s3_result_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.8ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.0ms | ActiveRecord: 0.8ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_requires_authentication
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.317864"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.317864"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.319347"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 6], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.319347"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_validates_runner_id
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.324339"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.324339"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.325876"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 7], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.325876"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.327415"], ["heartbeat_at", "2025-12-11 01:05:12.327421"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.327519"], ["id", 7]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/7/heartbeat" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#heartbeat as JSON
  Parameters: {"runner_id" => "wrong-runner", "status" => "running", "id" => "7", "task" => {"runner_id" => "wrong-runner", "status" => "running"}}
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.0ms | ActiveRecord: 0.5ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_assigns_a_task
----------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.333042"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.333042"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.334532"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 8], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.334532"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.2ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 8], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.339368"], ["heartbeat_at", "2025-12-11 01:05:12.339375"], ["runner_id", "i-12345"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.339493"], ["id", 8]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.0ms | ActiveRecord: 3.9ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.7ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_marks_task_as_completed
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.348350"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.348350"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.349715"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 9], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.349715"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.351451"], ["heartbeat_at", "2025-12-11 01:05:12.351457"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.351555"], ["id", 9]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/9/complete" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#complete as JSON
  Parameters: {"runner_id" => "runner-123", "s3_result_key" => "[FILTERED]", "id" => "9", "task" => {"runner_id" => "runner-123", "s3_result_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.6ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.6ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:05:12.354594"], ["id", 9]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mTask Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."status" IN ($2, $3, $4)[0m  [["run_id", 9], ["status", "pending"], ["status", "claimed"], ["status", "running"]]
[ActiveJob] Enqueued GzipBuilderJob (Job ID: bb80ae3d-086c-45b0-9c4a-088becbfe120) to Test(default) with arguments: 9
Completed 200 OK in 5ms (Views: 0.0ms | ActiveRecord: 4.1ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.4ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_wait_when_tasks_are_in_progress
-----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.363213"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.363213"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:12.364805"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 10], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:12.364805"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:12.366564"], ["heartbeat_at", "2025-12-11 01:05:12.366571"], ["runner_id", "other-runner"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:12.366682"], ["id", 10]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:05:12 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.1ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 10], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 10], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 2.9ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
RunTest: test_validates_runs_per_instance_type_is_positive
----------------------------------------------------------
  [1m[36mRun Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_validates_presence_of_required_fields
---------------------------------------------------
  [1m[36mRun Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
RunTest: test_creates_run_with_external_id
------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.382194"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.382194"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
RunTest: test_current_scope_returns_most_recent_running_run
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415112], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:12.386339"], ["external_id", 1765415112], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:12.386339"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (0.6ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:05:12.390431"], ["id", 12]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.400884"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.8"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.400884"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------
RunTest: test_validates_status_is_valid
---------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (10.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.419362"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.419362"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
RunTest: test_cancel!_changes_status_to_cancelled
-------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.432215"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.432215"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.2ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:05:13.434483"], ["id", 15]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_complete!_changes_status_to_completed
---------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.440772"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.440772"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.7ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:05:13.442556"], ["id", 16]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
TaskTest: test_stale_heartbeats_scope_finds_tasks_with_old_heartbeats
---------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.449019"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.449019"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.451311"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 17], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.451311"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:13.453734"], ["heartbeat_at", "2025-12-11 01:05:13.453751"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:13.453911"], ["id", 11]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.456280"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 17], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.456280"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:13.458418"], ["heartbeat_at", "2025-12-11 01:05:13.458432"], ["runner_id", "runner-456"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:13.458629"], ["id", 12]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.7ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_at" = $1 WHERE "tasks"."id" = $2[0m  [["heartbeat_at", "2025-12-11 01:02:13.460773"], ["id", 12]]
  [1m[36mTask Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 01:03:13.461792"], ["id", 11], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 01:03:13.461792"], ["id", 12], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_for_provider_and_type_scope_filters_correctly
------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.467556"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.467556"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.5ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.470688"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 18], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.470688"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.474550"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 18], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.474550"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 13], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 14], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
TaskTest: test_creates_task_with_default_pending_status
-------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.482763"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.482763"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.484935"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 19], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.484935"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_fail!_marks_task_as_failed_with_error_details
------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.491500"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.491500"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.495030"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 20], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.495030"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:13.497346"], ["heartbeat_at", "2025-12-11 01:05:13.497356"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:13.497516"], ["id", 16]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed to run"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:05:13.499541"], ["id", 16]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
TaskTest: test_update_heartbeat!_updates_status_and_timestamps
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (1.0ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.505088"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.505088"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.7ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.507371"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 21], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.507371"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.7ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:13.510200"], ["heartbeat_at", "2025-12-11 01:05:13.510213"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:13.510402"], ["id", 17]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:05:13.512936"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 45], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.513132"], ["id", 17]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TaskTest: test_mark_timeout_failed!_marks_task_as_failed_due_to_timeout
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.519415"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.519415"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.521485"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 22], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.521485"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (2.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:13.524013"], ["heartbeat_at", "2025-12-11 01:05:13.524022"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:13.524160"], ["id", 18]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["error_message", "No heartbeat received for 2 minutes. Last heartbeat: 2025-12-11 01:05:13 UTC"], ["error_type", "timeout"], ["heartbeat_status", "error"], ["status", "failed"], ["updated_at", "2025-12-11 01:05:13.527185"], ["id", 18]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
TaskTest: test_claim!_updates_task_status_and_timestamps
--------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.533934"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.533934"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.536202"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 23], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.536202"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.4ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:13.538392"], ["heartbeat_at", "2025-12-11 01:05:13.538402"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:13.538565"], ["id", 19]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
TaskTest: test_complete!_marks_task_as_completed
------------------------------------------------
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.544964"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.544964"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.547145"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 24], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.547145"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.6ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:05:13.549769"], ["heartbeat_at", "2025-12-11 01:05:13.549780"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:05:13.549939"], ["id", 20]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.6ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:05:13.552575"], ["id", 20]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_cancels_the_current_run
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.559505"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.559505"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:05:13 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
  [1m[36mRun Load (1.0ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.4ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:05:13.565271"], ["id", 25]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 3.6ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 25], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_400_if_no_instance_types_specified
-----------------------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:05:13 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 400 Bad Request in 1ms (Views: 0.0ms | ActiveRecord: 0.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_creates_a_new_run_with_tasks
---------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:05:13 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2, "aws" => ["c8g.medium"], "azure" => ["Standard_D2pls_v6"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2}}
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (1.1ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.579853"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.579853"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.582441"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 26], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.582441"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.585646"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 26], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.585646"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.588168"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 26], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.588168"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.591116"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 26], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:05:13.591116"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 17ms (Views: 0.1ms | ActiveRecord: 15.4ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (1.2ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_requires_authentication
----------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:05:13 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_requires_authentication
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.605030"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.605030"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:05:13 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_409_if_run_already_in_progress
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (6.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.619218"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.619218"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:05:13 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1}}
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 409 Conflict in 1ms (Views: 0.0ms | ActiveRecord: 0.8ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_404_if_no_run_exists
--------------------------------------------------------------
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:05:13 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.7ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 404 Not Found in 1ms (Views: 0.0ms | ActiveRecord: 0.7ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_current_run_status
------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415113], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:05:13.630729"], ["external_id", 1765415113], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.630729"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.632900"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 29], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:05:13.632900"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:05:13.635713"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 29], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "running"], ["updated_at", "2025-12-11 01:05:13.635713"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:05:13 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTask Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "tasks"."status" AS "tasks_status" FROM "tasks" WHERE "tasks"."run_id" = $1 GROUP BY "tasks"."status"[0m  [["run_id", 29]]
  [1m[36mTask Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1[0m  [["run_id", 29]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 2.4ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "runs" DISABLE TRIGGER ALL;ALTER TABLE "tasks" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mFixtures Load (0.9ms)[0m  [1m[31mDELETE FROM "runs";
DELETE FROM "tasks"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[35mALTER TABLE "runs" ENABLE TRIGGER ALL;ALTER TABLE "tasks" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (13.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (10.2ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_catalog.pg_constraint SET convalidated=false WHERE conname = ''%1$I'' AND connamespace::regnamespace = ''%2$I''::regnamespace; ALTER TABLE %2$I.%3$I VALIDATE CONSTRAINT %1$I;',
    constraint_name,
    table_schema,
    table_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (9.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_validates_runner_id
------------------------------------------------------------------
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (1.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.101071"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.101071"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.114217"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 1], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.114217"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.117271"], ["heartbeat_at", "2025-12-11 01:16:09.117292"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.117561"], ["id", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/1/fail" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#fail as JSON
  Parameters: {"runner_id" => "wrong-runner", "error_type" => "benchmark_error", "error_message" => "Benchmark failed", "id" => "1", "task" => {"error_message" => "Benchmark failed", "error_type" => "benchmark_error", "runner_id" => "wrong-runner"}}
  [1m[36mTask Load (2.4ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
Completed 403 Forbidden in 6ms (Views: 0.1ms | ActiveRecord: 3.3ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_wait_when_tasks_are_in_progress
-----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.156461"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.156461"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.159035"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 2], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.159035"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.3ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.161207"], ["heartbeat_at", "2025-12-11 01:16:09.161226"], ["runner_id", "other-runner"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.161429"], ["id", 2]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (1.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.4ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 2], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 2], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 5.1ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_validates_runner_id
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (1.0ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.173547"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.173547"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.175797"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 3], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.175797"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.177878"], ["heartbeat_at", "2025-12-11 01:16:09.177893"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.178054"], ["id", 3]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/3/heartbeat" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#heartbeat as JSON
  Parameters: {"runner_id" => "wrong-runner", "status" => "running", "id" => "3", "task" => {"runner_id" => "wrong-runner", "status" => "running"}}
  [1m[36mTask Load (0.9ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.1ms | ActiveRecord: 0.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_assigns_a_task
----------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.186173"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.186173"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.188015"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 4], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.188015"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.7ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (1.5ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 4], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Update (0.7ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.193246"], ["heartbeat_at", "2025-12-11 01:16:09.193270"], ["runner_id", "i-12345"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.193521"], ["id", 4]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 3.6ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.7ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_returns_done_when_all_tasks_completed
---------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (1.0ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.201869"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.201869"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.204182"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 5], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.204182"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.5ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.206609"], ["heartbeat_at", "2025-12-11 01:16:09.206636"], ["runner_id", "runner-1"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.206896"], ["id", 5]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.6ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:16:09.209340"], ["id", 5]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
  [1m[36mRun Load (0.5ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Load (0.9ms)[0m  [1m[37mSELECT "tasks".* FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" = $4 ORDER BY "tasks"."id" ASC LIMIT $5 FOR UPDATE[0m  [["run_id", 5], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "pending"], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."provider" = $2 AND "tasks"."instance_type" = $3 AND "tasks"."status" IN ($4, $5) LIMIT $6[0m  [["run_id", 5], ["provider", "aws"], ["instance_type", "c8g.medium"], ["status", "claimed"], ["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 3.0ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/heartbeat_updates_task_heartbeat
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.219927"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.219927"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.221822"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 6], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.221822"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.224027"], ["heartbeat_at", "2025-12-11 01:16:09.224035"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.224158"], ["id", 6]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/6/heartbeat" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#heartbeat as JSON
  Parameters: {"runner_id" => "runner-123", "status" => "running", "current_benchmark" => "optcarrot", "progress_pct" => 50, "message" => "Running benchmark", "id" => "6", "task" => {"current_benchmark" => "optcarrot", "progress_pct" => 50, "runner_id" => "runner-123", "status" => "running"}}
  [1m[36mTask Load (0.6ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:16:09.227234"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 50], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.227394"], ["id", 6]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 2.6ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.7ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_marks_task_as_completed
--------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.235222"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.235222"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.7ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.236938"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 7], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.236938"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.6ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.239789"], ["heartbeat_at", "2025-12-11 01:16:09.239805"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.239969"], ["id", 7]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/7/complete" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#complete as JSON
  Parameters: {"runner_id" => "runner-123", "s3_result_key" => "[FILTERED]", "id" => "7", "task" => {"runner_id" => "runner-123", "s3_result_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.7ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:16:09.243994"], ["id", 7]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (1.0ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mTask Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."status" IN ($2, $3, $4)[0m  [["run_id", 7], ["status", "pending"], ["status", "claimed"], ["status", "running"]]
[ActiveJob] Enqueued GzipBuilderJob (Job ID: eda8ea11-0b9d-4c51-82c2-82850f29ea4e) to Test(default) with arguments: 7
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 4.2ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.6ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/fail_marks_task_as_failed
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.254645"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.254645"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.256968"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 8], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.256968"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.258985"], ["heartbeat_at", "2025-12-11 01:16:09.258994"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.259116"], ["id", 8]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/8/fail" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#fail as JSON
  Parameters: {"runner_id" => "runner-123", "error_type" => "benchmark_error", "error_message" => "Benchmark failed", "s3_error_key" => "[FILTERED]", "id" => "8", "task" => {"error_message" => "Benchmark failed", "error_type" => "benchmark_error", "runner_id" => "runner-123", "s3_error_key" => "[FILTERED]"}}
  [1m[36mTask Load (1.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.8ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:16:09.263516"], ["id", 8]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (0.7ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mTask Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1 AND "tasks"."status" IN ($2, $3, $4)[0m  [["run_id", 8], ["status", "pending"], ["status", "claimed"], ["status", "running"]]
[ActiveJob] Enqueued GzipBuilderJob (Job ID: 8832b3c0-0e80-4ba3-ac84-040614c143ee) to Test(default) with arguments: 8
Completed 200 OK in 7ms (Views: 0.1ms | ActiveRecord: 6.3ms (4 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTask Load (0.5ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/claim_requires_authentication
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.274841"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.274841"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.276789"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 9], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.276789"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/claim" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#claim as JSON
  Parameters: {"provider" => "aws", "instance_type" => "c8g.medium", "runner_id" => "i-12345", "task" => {"instance_type" => "c8g.medium", "provider" => "aws", "runner_id" => "i-12345"}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
TasksControllerTest: test_POST_/tasks/:id/complete_validates_runner_id
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.283135"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.283135"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:09.285086"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 10], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:09.285086"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.0ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:09.287017"], ["heartbeat_at", "2025-12-11 01:16:09.287041"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:09.287218"], ["id", 10]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/tasks/10/complete" for 127.0.0.1 at 2025-12-11 10:16:09 +0900
Processing by TasksController#complete as JSON
  Parameters: {"runner_id" => "wrong-runner", "s3_result_key" => "[FILTERED]", "id" => "10", "task" => {"runner_id" => "wrong-runner", "s3_result_key" => "[FILTERED]"}}
  [1m[36mTask Load (0.8ms)[0m  [1m[34mSELECT "tasks".* FROM "tasks" WHERE "tasks"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
Completed 403 Forbidden in 1ms (Views: 0.1ms | ActiveRecord: 0.8ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------
RunTest: test_validates_status_is_valid
---------------------------------------
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.295734"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.295734"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
RunTest: test_validates_runs_per_instance_type_is_positive
----------------------------------------------------------
  [1m[36mRun Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_validates_presence_of_required_fields
---------------------------------------------------
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
RunTest: test_current_scope_returns_most_recent_running_run
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415769], ["LIMIT", 1]]
  [1m[36mRun Create (1.3ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:09.314524"], ["external_id", 1765415769], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:09.314524"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.1ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:16:09.316741"], ["id", 12]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (1.2ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.326001"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.8"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.326001"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mRun Load (1.0ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
RunTest: test_cancel!_changes_status_to_cancelled
-------------------------------------------------
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (1.0ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.340738"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.340738"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (13.4ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:16:10.344412"], ["id", 14]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
RunTest: test_creates_run_with_external_id
------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (1.1ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.364967"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.364967"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
RunTest: test_complete!_changes_status_to_completed
---------------------------------------------------
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.375178"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.375178"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.3ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "completed"], ["updated_at", "2025-12-11 01:16:10.378588"], ["id", 16]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_requires_authentication
----------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:16:10 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_requires_authentication
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.395878"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.395878"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:16:10 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
Filter chain halted as :authenticate_api_request! rendered or redirected
Completed 401 Unauthorized in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_409_if_run_already_in_progress
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.402542"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.402542"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:16:10 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1, "aws" => ["c8g.medium"], "run" => {"ruby_version" => "3.4.8", "runs_per_instance_type" => 1}}
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 409 Conflict in 2ms (Views: 0.1ms | ActiveRecord: 1.1ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
RunsControllerTest: test_POST_/run/stop_cancels_the_current_run
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.410532"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.410532"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/run/stop" for 127.0.0.1 at 2025-12-11 10:16:10 +0900
Processing by RunsController#stop as JSON
  Parameters: {"run" => {}}
  [1m[36mRun Load (0.7ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Update (1.5ms)[0m  [1m[33mUPDATE "runs" SET "status" = $1, "updated_at" = $2 WHERE "runs"."id" = $3[0m  [["status", "cancelled"], ["updated_at", "2025-12-11 01:16:10.413891"], ["id", 19]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 3.2ms (2 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (0.6ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_returns_400_if_no_instance_types_specified
-----------------------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:16:10 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3, "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 3}}
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_404_if_no_run_exists
--------------------------------------------------------------
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:16:10 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.9ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
Completed 404 Not Found in 2ms (Views: 0.1ms | ActiveRecord: 0.9ms (1 query, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
RunsControllerTest: test_POST_/run/start_creates_a_new_run_with_tasks
---------------------------------------------------------------------
Started POST "/run/start" for 127.0.0.1 at 2025-12-11 10:16:10 +0900
Processing by RunsController#create as JSON
  Parameters: {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2, "aws" => ["c8g.medium"], "azure" => ["Standard_D2pls_v6"], "run" => {"ruby_version" => "3.4.7", "runs_per_instance_type" => 2}}
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."status" = $1 LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.7ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.439951"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.439951"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.442046"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 20], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.442046"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.444718"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 20], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.444718"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.8ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.447450"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 20], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.447450"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.450864"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 20], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.450864"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 16ms (Views: 0.1ms | ActiveRecord: 13.5ms (7 queries, 0 cached) | GC: 0.0ms)
  [1m[36mRun Load (1.1ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
RunsControllerTest: test_GET_/run_returns_current_run_status
------------------------------------------------------------
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.8ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.465448"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 2], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.465448"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.467798"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 21], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:16:10.467798"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.6ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.471161"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 21], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.471161"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/run" for 127.0.0.1 at 2025-12-11 10:16:10 +0900
Processing by RunsController#show as HTML
  [1m[36mRun Load (0.7ms)[0m  [1m[34mSELECT "runs".* FROM "runs" WHERE "runs"."status" = $1 ORDER BY "runs"."created_at" DESC LIMIT $2[0m  [["status", "running"], ["LIMIT", 1]]
  [1m[36mTask Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) AS "count_all", "tasks"."status" AS "tasks_status" FROM "tasks" WHERE "tasks"."run_id" = $1 GROUP BY "tasks"."status"[0m  [["run_id", 21]]
  [1m[36mTask Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "tasks" WHERE "tasks"."run_id" = $1[0m  [["run_id", 21]]
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 2.4ms (3 queries, 0 cached) | GC: 0.0ms)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_fail!_marks_task_as_failed_with_error_details
------------------------------------------------------------
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (1.0ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.491129"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.491129"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (5.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (6.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.497087"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 22], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.497087"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.7ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:10.506100"], ["heartbeat_at", "2025-12-11 01:16:10.506135"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:10.506421"], ["id", 17]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.7ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "s3_error_key" = $4, "status" = $5, "updated_at" = $6 WHERE "tasks"."id" = $7[0m  [["error_message", "Benchmark failed to run"], ["error_type", "benchmark_error"], ["heartbeat_status", "error"], ["s3_error_key", "[FILTERED]"], ["status", "failed"], ["updated_at", "2025-12-11 01:16:10.509432"], ["id", 17]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------
TaskTest: test_update_heartbeat!_updates_status_and_timestamps
--------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.9ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.516284"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.516284"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.4ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.518691"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 23], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.518691"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:10.520804"], ["heartbeat_at", "2025-12-11 01:16:10.520814"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:10.520944"], ["id", 18]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.5ms)[0m  [1m[33mUPDATE "tasks" SET "current_benchmark" = $1, "heartbeat_at" = $2, "heartbeat_message" = $3, "heartbeat_status" = $4, "progress_pct" = $5, "status" = $6, "updated_at" = $7 WHERE "tasks"."id" = $8[0m  [["current_benchmark", "optcarrot"], ["heartbeat_at", "2025-12-11 01:16:10.523043"], ["heartbeat_message", "Running benchmark"], ["heartbeat_status", "running"], ["progress_pct", 45], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.523259"], ["id", 18]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
TaskTest: test_mark_timeout_failed!_marks_task_as_failed_due_to_timeout
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.528450"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.528450"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.1ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.530173"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 24], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.530173"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:10.532115"], ["heartbeat_at", "2025-12-11 01:16:10.532126"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:10.532307"], ["id", 19]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "error_message" = $1, "error_type" = $2, "heartbeat_status" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["error_message", "No heartbeat received for 2 minutes. Last heartbeat: 2025-12-11 01:16:10 UTC"], ["error_type", "timeout"], ["heartbeat_status", "error"], ["status", "failed"], ["updated_at", "2025-12-11 01:16:10.534311"], ["id", 19]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------------
TaskTest: test_stale_heartbeats_scope_finds_tasks_with_old_heartbeats
---------------------------------------------------------------------
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.539541"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.539541"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.3ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.541440"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 25], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.541440"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:10.543400"], ["heartbeat_at", "2025-12-11 01:16:10.543406"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:10.543545"], ["id", 20]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (0.9ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.545233"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 25], ["run_number", 2], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.545233"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.9ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:10.546760"], ["heartbeat_at", "2025-12-11 01:16:10.546766"], ["runner_id", "runner-456"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:10.546850"], ["id", 21]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Update (0.5ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_at" = $1 WHERE "tasks"."id" = $2[0m  [["heartbeat_at", "2025-12-11 01:13:10.548247"], ["id", 21]]
  [1m[36mTask Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 01:14:10.548955"], ["id", 20], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."status" IN ($1, $2) AND (heartbeat_at < $3) AND "tasks"."id" = $4 LIMIT $5[0m  [["status", "claimed"], ["status", "running"], [nil, "2025-12-11 01:14:10.548955"], ["id", 21], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------
TaskTest: test_for_provider_and_type_scope_filters_correctly
------------------------------------------------------------
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.553464"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.553464"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.2ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.554893"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 26], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.554893"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.557143"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "Standard_D2pls_v6"], ["progress_pct", nil], ["provider", "azure"], ["run_id", 26], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.557143"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTask Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 22], ["LIMIT", 1]]
  [1m[36mTask Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "tasks" WHERE "tasks"."provider" = $1 AND "tasks"."instance_type" = $2 AND "tasks"."id" = $3 LIMIT $4[0m  [["provider", "aws"], ["instance_type", "c8g.medium"], ["id", 23], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
TaskTest: test_claim!_updates_task_status_and_timestamps
--------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.565468"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.565468"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.566939"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 27], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.566939"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:10.568472"], ["heartbeat_at", "2025-12-11 01:16:10.568478"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:10.568578"], ["id", 24]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
TaskTest: test_creates_task_with_default_pending_status
-------------------------------------------------------
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.6ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.573244"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.573244"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.0ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.574739"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 28], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.574739"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
TaskTest: test_complete!_marks_task_as_completed
------------------------------------------------
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mRun Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "runs" WHERE "runs"."external_id" = $1 LIMIT $2[0m  [["external_id", 1765415770], ["LIMIT", 1]]
  [1m[36mRun Create (0.5ms)[0m  [1m[32mINSERT INTO "runs" ("created_at", "external_id", "gzip_url", "ruby_version", "runs_per_instance_type", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", "2025-12-11 01:16:10.578923"], ["external_id", 1765415770], ["gzip_url", nil], ["ruby_version", "3.4.7"], ["runs_per_instance_type", 3], ["status", "running"], ["updated_at", "2025-12-11 01:16:10.578923"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Create (1.7ms)[0m  [1m[32mINSERT INTO "tasks" ("claimed_at", "created_at", "current_benchmark", "error_message", "error_type", "heartbeat_at", "heartbeat_message", "heartbeat_status", "instance_type", "progress_pct", "provider", "run_id", "run_number", "runner_id", "s3_error_key", "s3_result_key", "status", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18) RETURNING "id"[0m  [["claimed_at", nil], ["created_at", "2025-12-11 01:16:10.580925"], ["current_benchmark", nil], ["error_message", nil], ["error_type", nil], ["heartbeat_at", nil], ["heartbeat_message", nil], ["heartbeat_status", nil], ["instance_type", "c8g.medium"], ["progress_pct", nil], ["provider", "aws"], ["run_id", 29], ["run_number", 1], ["runner_id", nil], ["s3_error_key", "[FILTERED]"], ["s3_result_key", "[FILTERED]"], ["status", "pending"], ["updated_at", "2025-12-11 01:16:10.580925"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.1ms)[0m  [1m[33mUPDATE "tasks" SET "claimed_at" = $1, "heartbeat_at" = $2, "runner_id" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["claimed_at", "2025-12-11 01:16:10.583949"], ["heartbeat_at", "2025-12-11 01:16:10.583975"], ["runner_id", "runner-123"], ["status", "claimed"], ["updated_at", "2025-12-11 01:16:10.584300"], ["id", 26]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTask Update (1.2ms)[0m  [1m[33mUPDATE "tasks" SET "heartbeat_status" = $1, "progress_pct" = $2, "s3_result_key" = $3, "status" = $4, "updated_at" = $5 WHERE "tasks"."id" = $6[0m  [["heartbeat_status", "finished"], ["progress_pct", 100], ["s3_result_key", "[FILTERED]"], ["status", "completed"], ["updated_at", "2025-12-11 01:16:10.586907"], ["id", 26]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
